apiVersion: tf.upbound.io/v1beta1
kind: Workspace
metadata:
  name: blanketops-terraform-aws-workspaces
spec:
  forProvider:
    module: |
      resource "aws_vpc" "main" {
        cidr_block       = "172.31.0.0/16"
        tags = {
          Name = var.vpcName
        }
      }

      resource "aws_ami_from_instance" "example" {
         name               = "terraform-example"
         source_instance_id = "i-xxxxxxxx"
      }

      resource "aws_subnet" "main" {
        vpc_id     = aws_vpc.main.id
        cidr_block = "172.31.0.0/16"
      }
      output "vpc_id" {
        value       = aws_vpc.main.id
      }
      output "subnet_data" {
        value = {
          "id" = aws_subnet.main.id
          "arn" = aws_subnet.main.arn
        }
      }
      variable "vpcName" {
        description = "VPC name"
        type        = string
      }
    source: Inline
    vars:
    - key: vpcName
      value: blanketops-terraform-aws-workspace
  providerConfigRef:
    name: aws-eu-north-1
